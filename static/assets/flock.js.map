{"version":3,"file":"generated.js","sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/cookie.js","src/flock.js","src/query.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","flock","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"create","name","value","days","date","Date","setTime","getTime","expires","toGMTString","document","cookie","read","nameEQ","ca","split","c","charAt","substring","indexOf","erase","query","pname","CLIENT","CLAIM_TOKEN","getParameter","parameter","post","payload","message","claim_token","flockClient","messageString","JSON","stringify","uri","encodeURIComponent","iframe","createElement","width","height","tabIndex","style","src","body","appendChild","parentNode","removeChild","target","parent","opener","postMessage","callback","OPEN_WIDGET","OPEN_BROWSER","CLOSE","widget","MODAL","SIDEBAR","ATTACHMENT","openWidget","url","desktopType","mobileType","openBrowser","sendContext","close","clientInfo","client","claimToken","init","set","parse","params","match","pl","search","decode","decodeURIComponent","replace","location","exec"],"mappings":"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B,EAAAG,MAAA,OAKAjF,EAAA6F,WAAA,WACA,OACAC,OAAA3C,EAAAH,EAAAC,QACA8C,WAAA5C,EAAAH,EAAAE,cAMA,IAAA8C,GAAA,WAGA,GAAAC,GAAA,SAAAtE,GACA,GAAAC,GAAAmB,EAAAK,UAAAzB,EACAC,IACAS,EAAAX,OAAAC,EAAAC,GAGAqE,GAAAjD,EAAAC,QACAgD,EAAAjD,EAAAE,aAEA8C,2DCtIA,GAAAE,GAAA,WACA,GAAAC,GAAA,IACA,OAAA,YACA,GAAA,OAAAA,EACA,MAAAA,EAGA,IAAAC,GACAC,EAAA,MACAC,EAAA,qBACAC,EAAA,SAAAzF,GAAA,MAAA0F,oBAAA1F,EAAA2F,QAAAJ,EAAA,OACAtD,EAAA1C,OAAAqG,SAAAJ,OAAA1D,UAAA,EAGA,KADAuD,KACAC,EAAAE,EAAAK,KAAA5D,IACAoD,EAAAI,EAAAH,EAAA,KAAAG,EAAAH,EAAA,GAGA,OAAAD,MAIAnG,GAAAoD,UAAA,SAAAzB,GACA,MAAAuE,KAAAvE;AFzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// Cookie manipulation\n// Source: http://www.quirksmode.org/js/cookies.html\n\nexports.create = function (name, value, days) {\n    if (days) {\n        var date = new Date();\n        date.setTime(date.getTime()+(days*24*60*60*1000));\n        var expires = \"; expires=\"+date.toGMTString();\n    }\n    else var expires = \"\";\n    document.cookie = name+\"=\"+value+expires+\"; path=/\";\n}\n\nexports.read = function (name) {\n    var nameEQ = name + \"=\";\n    var ca = document.cookie.split(';');\n    for(var i=0;i < ca.length;i++) {\n        var c = ca[i];\n        while (c.charAt(0)==' ') c = c.substring(1,c.length);\n        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n    }\n    return null;\n}\n\nexports.erase = function (name) {\n    exports.create(name,\"\",-1);\n}\n","/*\n  For more details see https://docs.google.com/a/riva.co/document/d/1OrqUgxj9HhDLGCrQr1bBZiwu5AlIN8ilSwrIXHyblyY/edit?usp=sharing\n\n  To register,\n\n  flock.register();\n\n  To post a message back to Flock,\n\n  var message = new flock.Message(...);\n  message.addPreviewHTML(...);\n  message.addPreviewImage(...);\n  message.addDownloadLink(...);\n\n  if (!flock.sendMessage(message)) {\n  console.log(\"Couldn't post message\");\n  }\n\n  To change mode,\n\n  if (!flock.changeMode(\"edit\")) {\n  console.log(\"Couldn't change mode\");\n  }\n\n  To close window,\n\n  if (!flock.closeWindow()) {\n  console.log(\"Couldn't close window\");\n  }\n*/\n\nvar cookie = require(\"./cookie.js\");\nvar query = require(\"./query.js\");\n\nvar pname = {\n    CLIENT: \"flockClient\",\n    CLAIM_TOKEN: \"flockClaimToken\"\n}\n\nvar getParameter = function (name) {\n    return query.parameter(name) || cookie.read(name);\n}\n\nvar post = exports.post = function (name, payload) {\n    var message = { name: name,\n                    payload: payload,\n                    claim_token: getParameter(pname.CLAIM_TOKEN) || \"\"\n                  };\n\n    var flockClient = getParameter(pname.CLIENT);\n    if (flockClient === \"iOS\" || flockClient == \"android\") {\n        var messageString = JSON.stringify(message);\n        var uri = \"flockback://localhost/send?message=\" + encodeURIComponent(messageString);\n        iframe = document.createElement(\"iframe\");\n        iframe.width = iframe.height = 0;\n        iframe.tabIndex = -1;\n        iframe.style = \"display: none\";\n        iframe.src = uri;\n        document.body.appendChild(iframe);\n        iframe.parentNode.removeChild(iframe);\n        iframe = null;\n        return true;\n    } else if (flockClient == \"desktop\") {\n        var target = null;\n        if (window.parent !== window) {\n            target = window.parent;\n        } else if (window.opener) {\n            target = window.opener;\n        }\n        if (target) {\n            target.postMessage(message, \"*\");\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    return false;\n};\n\n// Wrappers\n\nvar callback = {\n    OPEN_WIDGET: \"openWidget\",\n    OPEN_BROWSER: \"openBrowser\",\n    CLOSE: \"close\"\n};\n\nvar widget = exports.widget = {\n    MODAL: \"modal\",\n    SIDEBAR: \"sidebar\",\n    ATTACHMENT: \"attachment\"\n}\n\nexports.openWidget = function (url, desktopType, mobileType) {\n    return post(callback.OPEN_WIDGET, {\n        url: url,\n        desktopType: desktopType,\n        mobileType: mobileType || widget.MODAL\n    });\n};\n\nexports.openBrowser = function (url, sendContext) {\n    return post(callback.OPEN_BROWSER, {\n        url: url,\n        sendContext: sendContext || false\n    });\n};\n\nexports.close = function () {\n    return post(callback.CLOSE, null);\n};\n\n// debug\n\nexports.clientInfo = function () {\n    return {\n        client: getParameter(pname.CLIENT),\n        claimToken: getParameter(pname.CLAIM_TOKEN)\n    };\n};\n\n// Init\n\nvar init = function () {\n    // store flockClient and flockClaimToken in a cookie so that we\n    // can access them even if the widget moves to a different page\n    var set = function (name) {\n        var value = query.parameter(name);\n        if (value) {\n            cookie.create(name, value);\n        }\n    };\n    set(pname.CLIENT);\n    set(pname.CLAIM_TOKEN);\n};\ninit();\n","// Get URL parameters\n// Source: http://stackoverflow.com/a/2880929/150941\nvar parse = (function () {\n    var params = null;\n    return function () {\n        if (params !== null) {\n            return params;\n        }\n\n        var match,\n            pl     = /\\+/g,\n            search = /([^&=]+)=?([^&]*)/g,\n            decode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); },\n            query  = window.location.search.substring(1);\n\n        params = {};\n        while (match = search.exec(query)) {\n            params[decode(match[1])] = decode(match[2]);\n        }\n\n        return params;\n    };\n})();\n\nexports.parameter = function (name) {\n    return parse()[name];\n}\n"]}